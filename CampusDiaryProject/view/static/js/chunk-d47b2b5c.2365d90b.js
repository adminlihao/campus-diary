(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d47b2b5c"],{"8e2a":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.msgShow,expression:"msgShow"}]},[n("van-nav-bar",{attrs:{title:"消息",fixed:""}}),n("van-pull-refresh",{staticStyle:{"min-height":"100vh"},attrs:{"success-text":"刷新成功"},on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[n("div",{staticClass:"msgBox"},[n("div",{staticClass:"topnav"},[n("van-row",{attrs:{type:"flex",justify:"space-around"}},[n("van-col",{on:{click:function(e){return t.skipToLike()}}},[n("van-badge",{directives:[{name:"show",rawName:"v-show",value:t.notifyCount.giveLike,expression:"notifyCount.giveLike"}],attrs:{content:t.notifyCount.giveLike}}),n("van-icon",{staticStyle:{"background-color":"rgb(255,237,235)"},attrs:{name:"like",size:"24px",color:"rgb(252,94,91)"}}),n("span",[t._v("赞和收藏")])],1),n("van-col",{on:{click:function(e){return t.skipToFocus()}}},[n("van-badge",{directives:[{name:"show",rawName:"v-show",value:0!==t.notifyCount.follow,expression:"notifyCount.follow!==0"}],attrs:{content:t.notifyCount.follow}}),n("van-icon",{staticStyle:{"background-color":"rgb(231,240,255)"},attrs:{name:"friends",size:"24px",color:"rgb(54,134,255)"}}),n("span",[t._v("新增关注")])],1),n("van-col",{on:{click:function(e){return t.skipToComment()}}},[n("van-badge",{directives:[{name:"show",rawName:"v-show",value:0!==t.notifyCount.comment,expression:"notifyCount.comment!==0"}],attrs:{content:t.notifyCount.comment}}),n("van-icon",{staticStyle:{"background-color":"rgb(231,252,242)"},attrs:{name:"comment",size:"24px",color:"rgb(52,216,153)"}}),n("span",[t._v("评论和@")])],1)],1)],1),n("div",{staticClass:"bigmsg"},[n("div",t._l(t.msglist.data,(function(e,s){return n("div",{key:s,on:{click:function(n){return t.skipChat(e.user_info.userid)}}},[n("div",{staticClass:"msg"},[n("van-image",{attrs:{round:"",width:"50px",height:"50px",src:e.user_info.head_photo}}),n("div",{staticClass:"rightbox"},[n("div",{staticClass:"infomsf"},[n("span",{staticClass:"title"},[t._v(t._s(e.user_info.username))]),n("span",{staticClass:"timer"},[t._v(t._s(t.showMsg(e.history_data)[0]))])]),n("p",[t._v(t._s(t.showMsg(e.history_data)[2]))]),n("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.unreadChatNum(e.unreadInfo),expression:"unreadChatNum(item.unreadInfo)!=0"}],staticClass:"unreadChat"},[t._v(t._s(t.unreadChatNum(e.unreadInfo)))])])],1)])})),0)])])])],1)},o=[],a=n("1da1"),i=(n("d81d"),n("ac1f"),n("1276"),n("fb6a"),n("96cf"),n("fa7d")),r={data:function(){return{isLoading:!1,msglist:{},notifyCount:{},msgShow:!1}},methods:{onRefresh:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;setTimeout((function(){t.isLoading=!1,t.msglist=Object(i["a"])(t.$store.getters["messInfo/getAllMsg"]),console.log("刷新成功")}),e)},skipChat:function(t){this.$router.push({name:"Chatpage",query:{userId:t}})},skipToLike:function(){this.$router.push("/likeNotify")},skipToFocus:function(){this.$router.push("/focusNotify")},skipToComment:function(){this.$router.push("/commentNotify")},getNotifyCount:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/notify/getUnreadNotify");case 2:n=e.sent,s=n.data,"success"===s.status&&(t.notifyCount=s.unreadNotify);case 5:case"end":return e.stop()}}),e)})))()},getUnreadChat:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/notify/getUnreadChat");case 2:n=e.sent,s=n.data,"success"===s.status&&null!=s.unreadChatList&&0!==s.unreadChatList.length&&s.unreadChatList.map((function(e){0!=e.unread_num&&t.$set(t.msglist.data[e.chat_userid],"unreadInfo",e)})),t.msgShow=!0;case 6:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.onRefresh(0)},created:function(){try{this.msglist=Object(i["a"])(this.$store.getters["messInfo/getAllMsg"])}catch(t){console.log(t)}this.getNotifyCount(),this.getUnreadChat()},computed:{showMsg:function(){return function(t){var e=t.length,n=t[e-1].split("+");return n[0]=n[0].slice(5,19),n}},unreadChatNum:function(){return function(t){return void 0===t?0:t.unread_num}}}},u=r,c=(n("d615"),n("2877")),d=Object(c["a"])(u,s,o,!1,null,"1cbc1761",null);e["default"]=d.exports},"9d5e":function(t,e,n){},d615:function(t,e,n){"use strict";n("9d5e")}}]);
//# sourceMappingURL=chunk-d47b2b5c.2365d90b.js.map